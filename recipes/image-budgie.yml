name: sukarn-ublue-budgie
description: Customized budgie image.
base-image: quay.io/fedora-ostree-desktops/onyx
image-version: 40
#base-image: ghcr.io/ublue-os/onyx-main
#image-version: gts


modules:
  - type: default-flatpaks
    notify: false
    user:
      repo-url: https://dl.flathub.org/repo/flathub.flatpakrepo
      repo-name: flathub
      repo-title: "Flathub (user)"
## INSTALL
      install:
        - org.mozilla.firefox # Mozilla Firefox
        - io.github.ungoogled_software.ungoogled_chromium # Ungoogled Chromium
        - org.videolan.VLC # VLC
        - org.libreoffice.LibreOffice # LibreOffice


  - type: copy
    from: ghcr.io/ublue-os/config:latest
    src: /rpms
    dest: /tmp/config-rpms

  - type: copy
    from: ghcr.io/ublue-os/ublue-update:latest
    src: /rpms
    dest: /tmp/update-rpm

  - type: script
    scripts:
      - ublue-rpms.sh
      - ublue-update.sh # Must be after ublue-rpms.sh

  - type: rpm-ostree
    install:
      - flatpak-spawn
      - fzf # Needed by ujust
      - grub2-tools-extra
      - htop
      - just # Needed by ujust
      - libnotify # Needed by ublue-update
      - python3-pip # Required to install topgrade for ublue-update
      - python3-psutil # Needed by ublue-update
      - powerstat
      - smartmontools
      - squashfs-tools
      - symlinks
      - traceroute
      - zstd
    remove:
      - firefox
      - firefox-langpacks

  - type: akmods
    base: coreos-stable
    install:
      - wl

  - type: files
    files:
      - source: usr
        destination: /usr
      - source: laptop/usr
        destination: /usr
      - source: theme-v/usr
        destination: /usr

  - type: script
    scripts:
      - image_name-v.sh
      - initramfs.sh

  - type: signing # this sests up the proper policy & signing files for signed images to work fully
